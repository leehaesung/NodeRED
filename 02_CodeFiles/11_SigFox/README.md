# SigFox Module With Arduino

***
![SigFox_For_Arduino.jpg](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/01_Images/SigFox_For_Arduino.jpg)

***

## Setup Hardware Arduino

* Source Codes
[DemoApp.ino](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/02_SourceCodes/DemoApp.ino)

![Xkit-Power-Configurations-v7.jpg](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/01_Images/Xkit-Power-Configurations-v7.jpg)

***

## Setup Callback

SUBSCRIBE XKIT ON SIGFOX BACKEND

STEP 1: Go to https://backend.sigfox.com/activate

STEP 2: Choose Thinxtra logo

STEP 3: Choose your country

STEP 4: Enter device information
(Sigfox ID and PAC can be found on the
package)

STEP 5: Fill in account details.

STEP 6: Click Subscribe button.

Copy below that and paste there.
``````````````````````
{ 
"device":"{device}", 
"time":{time}, 
"duplicate":{duplicate}, 
"snr":{snr}, 
"station":"{station}", 
"data":"{data}", 
"avgSnr":{avgSnr}, 
"latlng":[{lat},{lng}], 
"rssi":{rssi}, 
"seqNumber":{seqNumber}, 
"name":"leo" 
}
``````````````````````

![SettingCallbackSigFoxWithArduino.png](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/01_Images/SettingCallbackSigFoxWithArduino.png)
***

***
## Node-RED 01

* Source Codes
[SigFox_Callback_NodeRED.txt](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/02_SourceCodes/SigFox_Callback_NodeRED.txt)

`````````````
[{"id":"9929205c.548a9","type":"http in","z":"aa66d99.61a3528","name":"","url":"/cback","method":"post","upload":false,"swaggerDoc":"","x":156.01095581054688,"y":65.00218963623047,"wires":[["ccf0248d.c8cb38","5e581130.ae853","737012d3.47e49c","a5c8291a.93d898","c0d83f6c.cc631","cda15dda.49268","b77aefd9.bb4af","6f3faeee.73752","cbd98463.496238","d349d8f0.d16de8","7be30da4.9f93c4","1e06166a.db135a","8ea495b3.df6208","36ef7c5f.7a34e4","f305e9f0.8d1f58"]]},{"id":"ccf0248d.c8cb38","type":"http response","z":"aa66d99.61a3528","name":"response","x":409.0109558105469,"y":65.00218963623047,"wires":[]},{"id":"5e581130.ae853","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"true","x":399.01093673706055,"y":103.00218486785889,"wires":[]},{"id":"5a99c0a3.0f198","type":"comment","z":"aa66d99.61a3528","name":"JSON Smaple","info":"{ \n\"device\":\"{device}\", \n\"time\":{time}, \n\"duplicate\":{duplicate}, \n\"snr\":{snr}, \n\"station\":\"{station}\", \n\"data\":\"{data}\", \n\"avgSnr\":{avgSnr}, \n\"latlng\":[{lat},{lng}], \n\"rssi\":{rssi}, \n\"seqNumber\":{seqNumber}, \n\"name\":\"leo\" \n}","x":614.6819076538086,"y":90.00213432312012,"wires":[]},{"id":"b162e9ac.9cd058","type":"comment","z":"aa66d99.61a3528","name":"Testing SigFox with Arduino","info":"","x":150.68202209472656,"y":25.00218963623047,"wires":[]},{"id":"737012d3.47e49c","type":"file","z":"aa66d99.61a3528","name":"","filename":"/home/ubuntu/callback.txt","appendNewline":true,"createDir":false,"overwriteFile":"false","x":457.0109558105469,"y":196.002197265625,"wires":[]},{"id":"f872bdfa.1460c","type":"function","z":"aa66d99.61a3528","name":"Parsing Device","func":"var device = msg.payload.toString().substr(11, 6);\nmsg.payload = '00' + device;\n\nreturn msg;","outputs":1,"noerr":0,"x":496.67982482910156,"y":238.66884231567383,"wires":[["c14cfe7f.b0496","1b29e385.f8e8fc"]]},{"id":"c14cfe7f.b0496","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":675.9151840209961,"y":279.3961658477783,"wires":[]},{"id":"d8afd1ed.07463","type":"comment","z":"aa66d99.61a3528","name":"Real JSON Data Location Table","info":"{\"device\":\"2BF0FA\",                     --> substr(11, 6)\n\"time\":1508852354,                      --> substr(26, 10)\n\"duplicate\":false,                      --> substr(49, 5)\n\"snr\":20.11,                            --> substr(61, 5)\n\"station\":\"35E6\",                       --> substr(78, 4)\n\"data\":\"5109c283a80102000100f700\",      --> substr(92, 24)\n\"avgSnr\":32.66,                         --> substr(127, 5)\n\"latlng\":[-34,151],                     --> substr(143, 7)\n\"rssi\":-123,                            --> substr(159, 4)\n\"seqNumber\":233,                        --> substr(176, 3)\n\"name\":\"leo\"}                           --> substr(188, 3)","x":674.6818389892578,"y":136.5679225921631,"wires":[]},{"id":"a5c8291a.93d898","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":343.92018127441406,"y":238.62828636169434,"wires":[["f872bdfa.1460c"]]},{"id":"ce2e0079.9adc2","type":"function","z":"aa66d99.61a3528","name":"Parsing Time","func":"var time = msg.payload.toString().substr(26, 10);\nmsg.payload = time;\n\nreturn msg;","outputs":1,"noerr":0,"x":487.63572692871094,"y":329.8815860748291,"wires":[["b896df12.91a47","5ae087c2.f530c8"]]},{"id":"b896df12.91a47","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":662.3155364990234,"y":374.4978094100952,"wires":[]},{"id":"c0d83f6c.cc631","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":344.87608337402344,"y":329.8410301208496,"wires":[["ce2e0079.9adc2"]]},{"id":"b7c5a314.93429","type":"function","z":"aa66d99.61a3528","name":"Parsing Duplicate","func":"var duplicate = msg.payload.toString().substr(49, 5);\nmsg.payload = duplicate;\n\nreturn msg;","outputs":1,"noerr":0,"x":511.6357116699219,"y":426.881591796875,"wires":[["3beea7c1.de01c8"]]},{"id":"3beea7c1.de01c8","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":694.3155212402344,"y":426.49780464172363,"wires":[]},{"id":"cda15dda.49268","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":348.8760681152344,"y":426.8410358428955,"wires":[["b7c5a314.93429"]]},{"id":"f49be8da.0e7028","type":"function","z":"aa66d99.61a3528","name":"Parsing SNR","func":"var snr = msg.payload.toString().substr(61, 5);\nmsg.payload = snr;\n\nreturn msg;","outputs":1,"noerr":0,"x":489.6357116699219,"y":467.881591796875,"wires":[["9bef45bf.0a9f48","4090d307.790d8c","4f241a2b.ecf634"]]},{"id":"9bef45bf.0a9f48","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":642.3155364990234,"y":540.4977884292603,"wires":[]},{"id":"b77aefd9.bb4af","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":346.8760681152344,"y":467.8410358428955,"wires":[["f49be8da.0e7028"]]},{"id":"54d0e802.09f878","type":"function","z":"aa66d99.61a3528","name":"Parsing Station","func":"var station = msg.payload.toString().substr(78, 4);\nmsg.payload = station;\n\nreturn msg;","outputs":1,"noerr":0,"x":499.6357116699219,"y":597.881591796875,"wires":[["4b8b105c.237a2"]]},{"id":"4b8b105c.237a2","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":685.6488723754883,"y":597.4977827072144,"wires":[]},{"id":"6f3faeee.73752","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":346.8760681152344,"y":597.8410358428955,"wires":[["54d0e802.09f878"]]},{"id":"6ddf169.0d61fe8","type":"function","z":"aa66d99.61a3528","name":"Parsing Data","func":"var data = msg.payload.toString().substr(92, 24);\nmsg.payload = data;\n\nreturn msg;","outputs":1,"noerr":0,"x":514.6357116699219,"y":673.881591796875,"wires":[["4ddde73.30dfc18","b4a9c2cf.a641b","89378a61.05a418","6fdc9143.63d02","99ef919a.7b9b1","dff9d222.6d053","7cf71fb3.93488"]]},{"id":"4ddde73.30dfc18","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":471.60114669799805,"y":721.4818334579468,"wires":[]},{"id":"cbd98463.496238","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":345.8760681152344,"y":673.8410358428955,"wires":[["6ddf169.0d61fe8"]]},{"id":"8d2e0cb5.0c4a6","type":"function","z":"aa66d99.61a3528","name":"Parsing AvgSnr","func":"var avgSnr = msg.payload.toString().substr(127, 5);\nmsg.payload = avgSnr;\n\nreturn msg;","outputs":1,"noerr":0,"x":500.6357116699219,"y":1260.881591796875,"wires":[["db439272.d582f","70e3313d.b7003"]]},{"id":"db439272.d582f","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":631.315544128418,"y":1308.497838973999,"wires":[]},{"id":"d349d8f0.d16de8","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":347.8760681152344,"y":1260.8410358428955,"wires":[["8d2e0cb5.0c4a6"]]},{"id":"21b3b33b.c020fc","type":"function","z":"aa66d99.61a3528","name":"Parsing LatLng","func":"var LatLng = msg.payload.toString().substr(143, 7);\nmsg.payload = LatLng;\n\nreturn msg;","outputs":1,"noerr":0,"x":501.6357116699219,"y":1351.881591796875,"wires":[["8e1f2fd0.21a6b","24cf0c8a.a59414","a261f5c2.251838"]]},{"id":"8e1f2fd0.21a6b","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":662.3155212402344,"y":1447.4977431297302,"wires":[]},{"id":"7be30da4.9f93c4","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":348.8760681152344,"y":1351.8410358428955,"wires":[["21b3b33b.c020fc"]]},{"id":"16bb2da3.8bf6a2","type":"function","z":"aa66d99.61a3528","name":"Parsing RSSI","func":"var rssi = msg.payload.toString().substr(159, 4);\nmsg.payload = rssi;\n\nreturn msg;","outputs":1,"noerr":0,"x":505.240966796875,"y":1490.8552856445312,"wires":[["10a79911.f6a767","bf0ad9a8.04db08","58ddcfba.2e528"]]},{"id":"10a79911.f6a767","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":641.9207725524902,"y":1581.4715967178345,"wires":[]},{"id":"1e06166a.db135a","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":352.4813232421875,"y":1490.8147296905518,"wires":[["16bb2da3.8bf6a2"]]},{"id":"43914d7b.2112a4","type":"function","z":"aa66d99.61a3528","name":"Parsing seqNumber","func":"var seqNumber = msg.payload.toString().substr(176, 3);\nmsg.payload = seqNumber;\n\nreturn msg;","outputs":1,"noerr":0,"x":522.3401794433594,"y":1626.355224609375,"wires":[["fe40a2a6.0815a"]]},{"id":"fe40a2a6.0815a","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":719.0199890136719,"y":1625.9714374542236,"wires":[]},{"id":"8ea495b3.df6208","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":349.5805358886719,"y":1626.3146686553955,"wires":[["43914d7b.2112a4"]]},{"id":"7ad4017.65438","type":"function","z":"aa66d99.61a3528","name":"Parsing Name","func":"var name = msg.payload.toString().substr(188, 3);\nmsg.payload = name;\n\nreturn msg;","outputs":1,"noerr":0,"x":505.67352294921875,"y":1688.0219116210938,"wires":[["cc3414b.d5804e8"]]},{"id":"cc3414b.d5804e8","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":722.3533325195312,"y":1687.6381244659424,"wires":[]},{"id":"36ef7c5f.7a34e4","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":352.91387939453125,"y":1687.9813556671143,"wires":[["7ad4017.65438"]]},{"id":"b4a9c2cf.a641b","type":"function","z":"aa66d99.61a3528","name":"Parsing Temperature","func":"var t1 = msg.payload.substr(0, 2);\nvar t2 = msg.payload.substr(2, 2);\n\nvar h1 = '0x' + t1;\nvar h2 = '0x' + t2;\n\nmsg.payload = (parseInt(h1 + h2))/100;\n\nreturn msg;","outputs":1,"noerr":0,"x":793.2123413085938,"y":674.6774376763237,"wires":[["24427730.9fc358","81e452d4.bd5c7","e212c919.27d988"]]},{"id":"24427730.9fc358","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":994.491943359375,"y":748.5998287200928,"wires":[]},{"id":"81e452d4.bd5c7","type":"ui_gauge","z":"aa66d99.61a3528","name":"","group":"cc0f0479.6cf808","order":1,"width":0,"height":0,"gtype":"gage","title":"Temperature","label":"[ 째C ]","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":996.7120132446289,"y":675.5921421051025,"wires":[]},{"id":"89378a61.05a418","type":"function","z":"aa66d99.61a3528","name":"Parsing Pressure","func":"var p1 = msg.payload.substr(4, 2);\nvar p2 = msg.payload.substr(6, 2);\n\nvar h1 = '0x' + p1;\nvar h2 = '0x' + p2;\n\nmsg.payload = (parseInt(h1 + h2))*3;\n\nreturn msg;","outputs":1,"noerr":0,"x":787.6734619140625,"y":787.355224609375,"wires":[["3b73c9de.34c576","bc7d8418.6be9a8"]]},{"id":"3b73c9de.34c576","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":998.9530639648438,"y":825.277615653144,"wires":[]},{"id":"bc7d8418.6be9a8","type":"ui_gauge","z":"aa66d99.61a3528","name":"","group":"ebb68fa3.34d5c","order":1,"width":0,"height":0,"gtype":"gage","title":"Pressure","label":"[ Pa ]","format":"{{value}}","min":0,"max":"10000","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":991.1731338500977,"y":788.2699290381538,"wires":[]},{"id":"6fdc9143.63d02","type":"function","z":"aa66d99.61a3528","name":"Parsing Photo","func":"var ph1 = msg.payload.substr(8, 2);\nvar ph2 = msg.payload.substr(10, 2);\n\nvar h1 = '0x' + ph1;\nvar h2 = '0x' + ph2;\n\nmsg.payload = parseInt(h1 + h2)/1000;\n\nreturn msg;","outputs":1,"noerr":0,"x":781.0068359375,"y":879.0219116210938,"wires":[["cff85a7a.209a98","bbdd054a.ffc858"]]},{"id":"cff85a7a.209a98","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":1002.2864379882812,"y":916.9443026648628,"wires":[]},{"id":"bbdd054a.ffc858","type":"ui_gauge","z":"aa66d99.61a3528","name":"","group":"be0122a7.bb908","order":1,"width":0,"height":0,"gtype":"gage","title":"Photo","label":"[ V ]","format":"{{value}}","min":0,"max":"5","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":984.5065078735352,"y":879.9366160498726,"wires":[]},{"id":"99ef919a.7b9b1","type":"function","z":"aa66d99.61a3528","name":"Parsing X_Acc","func":"var xa1 = msg.payload.substr(12, 2);\nvar xa2 = msg.payload.substr(14, 2);\n\nvar h1 = '0x' + xa1;\nvar h2 = '0x' + xa2;\n\nmsg.payload = parseInt(h1 + h2)/250;\n\nreturn msg;","outputs":1,"noerr":0,"x":775.3402099609375,"y":988.6885986328125,"wires":[["457e872.c21cd78","c8a51e10.4a674"]]},{"id":"457e872.c21cd78","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":996.6198120117188,"y":1026.6109896765815,"wires":[]},{"id":"c8a51e10.4a674","type":"ui_text","z":"aa66d99.61a3528","group":"75fe1cbc.54cbf4","order":1,"width":0,"height":0,"name":"","label":"X_Acc :","format":"{{msg.payload}} [ g ]","layout":"row-spread","x":989.4817123413086,"y":987.9657344818115,"wires":[]},{"id":"dff9d222.6d053","type":"function","z":"aa66d99.61a3528","name":"Parsing Y_Acc","func":"var ya1 = msg.payload.substr(16, 2);\nvar ya2 = msg.payload.substr(18, 2);\n\nvar h1 = '0x' + ya1;\nvar h2 = '0x' + ya2;\n\nmsg.payload = parseInt(h1 + h2)/250;\n\nreturn msg;","outputs":1,"noerr":0,"x":776.7277221679688,"y":1070.9285888671875,"wires":[["dcaa8f15.f6bca","e550ddd0.9d963"]]},{"id":"dcaa8f15.f6bca","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":998.00732421875,"y":1108.8509799109565,"wires":[]},{"id":"e550ddd0.9d963","type":"ui_text","z":"aa66d99.61a3528","group":"75fe1cbc.54cbf4","order":2,"width":0,"height":0,"name":"","label":"Y_Acc :","format":"{{msg.payload}} [ g ]","layout":"row-spread","x":990.8692245483398,"y":1070.2057247161865,"wires":[]},{"id":"7cf71fb3.93488","type":"function","z":"aa66d99.61a3528","name":"Parsing Z_Acc","func":"var za1 = msg.payload.substr(20, 2);\nvar za2 = msg.payload.substr(22, 2);\n\nvar h1 = '0x' + za1;\nvar h2 = '0x' + za2;\n\nmsg.payload = parseInt(h1 + h2)/250;\n\nreturn msg;","outputs":1,"noerr":0,"x":775.2991333007812,"y":1155.21435546875,"wires":[["a6ad7422.6341c8","37886d1b.8f84d2"]]},{"id":"a6ad7422.6341c8","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":996.5787353515625,"y":1193.136746512519,"wires":[]},{"id":"37886d1b.8f84d2","type":"ui_text","z":"aa66d99.61a3528","group":"75fe1cbc.54cbf4","order":3,"width":0,"height":0,"name":"","label":"Z_Acc :","format":"{{msg.payload}} [ g ]","layout":"row-spread","x":989.4406356811523,"y":1154.491491317749,"wires":[]},{"id":"1b29e385.f8e8fc","type":"ui_text","z":"aa66d99.61a3528","group":"9b16f3cb.f9612","order":0,"width":0,"height":0,"name":"","label":"Device Name :","format":"{{msg.payload}} ","layout":"row-spread","x":692.9556274414062,"y":238.0263214111328,"wires":[]},{"id":"5ae087c2.f530c8","type":"debug","z":"aa66d99.61a3528","name":"","active":true,"console":"false","complete":"false","x":672.5650596618652,"y":333.0172276496887,"wires":[]},{"id":"4090d307.790d8c","type":"ui_text","z":"aa66d99.61a3528","group":"2f7f82bd.1d62ee","order":1,"width":0,"height":0,"name":"","label":"SNR :","format":"{{msg.payload}} [ dB ]","layout":"row-spread","x":644.5690650939941,"y":467.3223133087158,"wires":[]},{"id":"24cf0c8a.a59414","type":"ui_text","z":"aa66d99.61a3528","group":"4e11cdbd.0c9894","order":0,"width":0,"height":0,"name":"","label":"GPS (Lat, Lon):","format":"{{msg.payload}}","layout":"row-spread","x":704.582218170166,"y":1351.2698183059692,"wires":[]},{"id":"70e3313d.b7003","type":"ui_text","z":"aa66d99.61a3528","group":"2f7f82bd.1d62ee","order":2,"width":0,"height":0,"name":"","label":"Average SNR :","format":"{{msg.payload}} [ dB ]","layout":"row-spread","x":708.5707397460936,"y":1262.27961730957,"wires":[]},{"id":"bf0ad9a8.04db08","type":"ui_text","z":"aa66d99.61a3528","group":"13a7b6cc.663f29","order":0,"width":0,"height":0,"name":"","label":"RSSI :","format":"{{msg.payload}} [ dBm ]","layout":"row-spread","x":672.5650024414061,"y":1492.2738800048826,"wires":[]},{"id":"e212c919.27d988","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"cc0f0479.6cf808","order":0,"width":0,"height":0,"label":"","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":981.1775545392717,"y":710.6041891915457,"wires":[[],[]]},{"id":"4f241a2b.ecf634","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"2f7f82bd.1d62ee","order":0,"width":0,"height":0,"label":"SNR","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":645.364044189453,"y":502.9341888427733,"wires":[[],[]]},{"id":"58ddcfba.2e528","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"13a7b6cc.663f29","order":0,"width":0,"height":0,"label":"RSSI","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":674.372833251953,"y":1530.9385833740232,"wires":[[],[]]},{"id":"a261f5c2.251838","type":"ui_template","z":"aa66d99.61a3528","group":"4e11cdbd.0c9894","name":"","order":0,"width":"6","height":"8","format":"<!DOCTYPE html>\n<html>\n  <head>\n    <title>Geolocation</title>\n    <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=yes\">\n    <meta charset=\"utf-8\">\n    <style>\n      /* Always set the map height explicitly to define the size of the div\n       * element that contains the map. */\n      #map {\n        height: 100%;\n      }\n      /* Optional: Makes the sample page fill the window. */\n      html, body {\n        height: 100%;\n        margin: 0;\n        padding: 0;\n      }\n    </style>\n  </head>\n  <body>\n    <div id=\"map\"></div>\n    <script>\n      // Note: This example requires that you consent to location sharing when\n      // prompted by your browser. If you see the error \"The Geolocation service\n      // failed.\", it means you probably did not give permission for the browser to\n      // locate you.\n      var map, infoWindow;\n      function initMap() {\n        map = new google.maps.Map(document.getElementById('map'), {\n          center: {lat: -33.8718172, lng: 151.22357009999996},\n          zoom: 10\n        });\n        infoWindow = new google.maps.InfoWindow;\n\n        // Try HTML5 geolocation.\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(function(position) {\n            var pos = {\n              lat: position.coords.latitude,\n              lng: position.coords.longitude\n            };\n\n            infoWindow.setPosition(pos);\n            infoWindow.setContent('Location found.');  \n            infoWindow.open(map);\n            map.setCenter(pos);\n          }, function() {\n            handleLocationError(true, infoWindow, map.getCenter());\n          });\n        } else {\n          // Browser doesn't support Geolocation\n          handleLocationError(false, infoWindow, map.getCenter());\n        }\n      }\n\n      function handleLocationError(browserHasGeolocation, infoWindow, pos) {\n        infoWindow.setPosition(pos);\n        infoWindow.setContent(browserHasGeolocation ?\n                              'Error: The Geolocation service failed.' :\n                              'Error: Your browser doesn\\'t support geolocation.');\n        infoWindow.open(map);\n      }\n    </script>\n    \n    <script \n       async defer src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyCZGidTDaBe3A7Jekh0Gy45BFKG_aKcTnU&callback=initMap\">\n    </script>\n    \n  </body>\n</html>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":683.3594589233398,"y":1396.850640296936,"wires":[["416b781d.4287e8"]]},{"id":"be1c7906.1da588","type":"template","z":"aa66d99.61a3528","name":"SigFox with Arduino","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!DOCTYPE html>\n<html>\n  <head>\n    <style>\n       #map {\n        height: 400px;\n        width: 100%;\n       }\n    </style>\n  </head>\n  <body>\n    <h2>Where is my IoT device?</h2>\n\n    <h2>My IoT Device Location: Latitude: {{payload.latitude}}  , Longitude: {{payload.longitude}} </h2>\n    <div id=\"map\"></div>\n    <script>\n      function initMap() {\n        var IoTDevice = {lat: {{payload.latitude}},lng: {{payload.longitude}} };\n        var map = new google.maps.Map(document.getElementById('map'), {\n          zoom: 13,\n          center: IoTDevice\n        });\n        var marker = new google.maps.Marker({\n          position: IoTDevice,\n          map: map\n        });\n      }\n    </script>\n    <script async defer\n        src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyCZGidTDaBe3A7Jekh0Gy45BFKG_aKcTnU&callback=initMap\">\n    </script>\n    \n    <iframe src=\"http://ec2-54-153-177-45.ap-southeast-2.compute.amazonaws.com:1880/ui/#/5\" width=\"100%\" height=\"1000\" scrolling=\"yes\">\n       <p>Your browser does not support iframes.</p>\n    </iframe>\n    \n  </body>\n</html>","x":1360.653564453125,"y":290.00439453125,"wires":[["3b0b545.fbc4bac"]]},{"id":"a2e608b3.7515a8","type":"http in","z":"aa66d99.61a3528","name":"/sigfox","url":"/sigfox","method":"get","upload":false,"swaggerDoc":"","x":1030.653564453125,"y":170.00439453125,"wires":[["a431f786.912468"]]},{"id":"3b0b545.fbc4bac","type":"http response","z":"aa66d99.61a3528","name":"","statusCode":"","headers":{},"x":1530.653564453125,"y":350.00439453125,"wires":[]},{"id":"a431f786.912468","type":"function","z":"aa66d99.61a3528","name":"RemoteData","func":"msg.payload = {'latitude':-33.8718172,'longitude':151.22357009999996};\nreturn msg;","outputs":1,"noerr":0,"x":1210.653564453125,"y":230.00439453125,"wires":[["be1c7906.1da588"]]},{"id":"f305e9f0.8d1f58","type":"mqtt out","z":"aa66d99.61a3528","name":"","topic":"cback","qos":"2","retain":"","broker":"954cd2e.c49463","x":400.6820526123047,"y":142.11841583251953,"wires":[]},{"id":"416b781d.4287e8","type":"debug","z":"aa66d99.61a3528","name":"","active":true,"console":"false","complete":"false","x":843.9340591430664,"y":1398.1381216049194,"wires":[]},{"id":"cc0f0479.6cf808","type":"ui_group","z":"","name":"Temperature","tab":"a620826e.45488","order":1,"disp":true,"width":"6"},{"id":"ebb68fa3.34d5c","type":"ui_group","z":"","name":"Pressure","tab":"a620826e.45488","order":2,"disp":true,"width":"6"},{"id":"be0122a7.bb908","type":"ui_group","z":"","name":"Photo","tab":"a620826e.45488","order":3,"disp":true,"width":"6"},{"id":"75fe1cbc.54cbf4","type":"ui_group","z":"","name":"Accelerometer","tab":"a620826e.45488","order":4,"disp":true,"width":"6"},{"id":"9b16f3cb.f9612","type":"ui_group","z":"","name":"Device","tab":"a620826e.45488","order":5,"disp":true,"width":"6"},{"id":"2f7f82bd.1d62ee","type":"ui_group","z":"","name":"SNR","tab":"a620826e.45488","order":6,"disp":true,"width":"6"},{"id":"4e11cdbd.0c9894","type":"ui_group","z":"","name":"GPS","tab":"a620826e.45488","order":8,"disp":true,"width":"6"},{"id":"13a7b6cc.663f29","type":"ui_group","z":"","name":"RSSI","tab":"a620826e.45488","order":7,"disp":true,"width":"6"},{"id":"954cd2e.c49463","type":"mqtt-broker","z":"","broker":"iot.eclipse.org","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"willTopic":"","willQos":"0","willPayload":"","birthTopic":"","birthQos":"0","birthPayload":""},{"id":"a620826e.45488","type":"ui_tab","z":"","name":"SigFox with Arduino","icon":"dashboard"}]

`````````````


![SigFox_Arduino_Nod-RED.png](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/01_Images/SigFox_Arduino_Nod-RED.png)

![sigfoxWithArduino_GPS.png](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/01_Images/sigfoxWithArduino_GPS.png)

***
## Node-RED 02

* Source Codes (With SQL)
[SigFox_With_SQLite3_NodeRED.txt](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/02_SourceCodes/SigFox_With_SQLite3_NodeRED.txt)
```
[{"id":"9929205c.548a9","type":"http in","z":"aa66d99.61a3528","name":"","url":"/cback","method":"post","upload":false,"swaggerDoc":"","x":251.01095581054688,"y":72.00218963623047,"wires":[["ccf0248d.c8cb38","5e581130.ae853","737012d3.47e49c","a5c8291a.93d898","c0d83f6c.cc631","cda15dda.49268","b77aefd9.bb4af","6f3faeee.73752","cbd98463.496238","d349d8f0.d16de8","7be30da4.9f93c4","1e06166a.db135a","8ea495b3.df6208","36ef7c5f.7a34e4","f305e9f0.8d1f58"]]},{"id":"ccf0248d.c8cb38","type":"http response","z":"aa66d99.61a3528","name":"response","x":504.0109558105469,"y":72.00218963623047,"wires":[]},{"id":"5e581130.ae853","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"true","x":494.01093673706055,"y":110.00218486785889,"wires":[]},{"id":"5a99c0a3.0f198","type":"comment","z":"aa66d99.61a3528","name":"JSON Smaple","info":"{ \n\"device\":\"{device}\", \n\"time\":{time}, \n\"duplicate\":{duplicate}, \n\"snr\":{snr}, \n\"station\":\"{station}\", \n\"data\":\"{data}\", \n\"avgSnr\":{avgSnr}, \n\"latlng\":[{lat},{lng}], \n\"rssi\":{rssi}, \n\"seqNumber\":{seqNumber}, \n\"name\":\"leo\" \n}","x":709.6819076538086,"y":97.00213432312012,"wires":[]},{"id":"b162e9ac.9cd058","type":"comment","z":"aa66d99.61a3528","name":"Testing SigFox with Arduino","info":"","x":245.68202209472656,"y":32.00218963623047,"wires":[]},{"id":"737012d3.47e49c","type":"file","z":"aa66d99.61a3528","name":"","filename":"/home/ubuntu/callback.txt","appendNewline":true,"createDir":false,"overwriteFile":"false","x":552.0109558105469,"y":203.002197265625,"wires":[]},{"id":"f872bdfa.1460c","type":"function","z":"aa66d99.61a3528","name":"Parsing Device","func":"var device = msg.payload.toString().substr(11, 6);\nmsg.payload = '00' + device;\n\nreturn msg;","outputs":1,"noerr":0,"x":591.6798248291016,"y":245.66884231567383,"wires":[["c14cfe7f.b0496","1b29e385.f8e8fc"]]},{"id":"c14cfe7f.b0496","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":770.9151840209961,"y":286.3961658477783,"wires":[]},{"id":"d8afd1ed.07463","type":"comment","z":"aa66d99.61a3528","name":"Real JSON Data Location Table","info":"{\"device\":\"2BF0FA\",                     --> substr(11, 6)\n\"time\":1508852354,                      --> substr(26, 10)\n\"duplicate\":false,                      --> substr(49, 5)\n\"snr\":20.11,                            --> substr(61, 5)\n\"station\":\"35E6\",                       --> substr(78, 4)\n\"data\":\"5109c283a80102000100f700\",      --> substr(92, 24)\n\"avgSnr\":32.66,                         --> substr(127, 5)\n\"latlng\":[-34,151],                     --> substr(143, 7)\n\"rssi\":-123,                            --> substr(159, 4)\n\"seqNumber\":233,                        --> substr(176, 3)\n\"name\":\"leo\"}                           --> substr(188, 3)","x":769.6818389892578,"y":143.5679225921631,"wires":[]},{"id":"a5c8291a.93d898","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":438.92018127441406,"y":245.62828636169434,"wires":[["f872bdfa.1460c"]]},{"id":"ce2e0079.9adc2","type":"function","z":"aa66d99.61a3528","name":"Parsing UTC Time","func":"var timeStamp = msg.payload.toString().substr(26, 10);\nvar realTime = Date(timeStamp); //.toLocalDate();\nvar filteringTime = realTime.toString().substr(0, 24);\nmsg.payload = filteringTime;  //substr(19, 2)\n\nreturn msg;\n","outputs":1,"noerr":0,"x":616.2071151733398,"y":369.88150548934937,"wires":[["b896df12.91a47"]]},{"id":"b896df12.91a47","type":"debug","z":"aa66d99.61a3528","name":"","active":true,"console":"false","complete":"false","x":803.5655364990234,"y":370.24771881103516,"wires":[]},{"id":"c0d83f6c.cc631","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":439.87608337402344,"y":336.8410301208496,"wires":[["ce2e0079.9adc2","5f16818f.2a8f1","a3e3b707.5fcb88"]]},{"id":"b7c5a314.93429","type":"function","z":"aa66d99.61a3528","name":"Parsing Duplicate","func":"var duplicate = msg.payload.toString().substr(49, 5);\nmsg.payload = duplicate;\n\nreturn msg;","outputs":1,"noerr":0,"x":606.6357116699219,"y":499.881591796875,"wires":[["3beea7c1.de01c8"]]},{"id":"3beea7c1.de01c8","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":789.3155212402344,"y":499.49780464172363,"wires":[]},{"id":"cda15dda.49268","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":443.8760681152344,"y":499.8410358428955,"wires":[["b7c5a314.93429"]]},{"id":"f49be8da.0e7028","type":"function","z":"aa66d99.61a3528","name":"Parsing SNR","func":"var snr = msg.payload.toString().substr(61, 5);\nmsg.payload = parseFloat(snr);\n\nreturn msg;","outputs":1,"noerr":0,"x":584.6357116699219,"y":540.881591796875,"wires":[["9bef45bf.0a9f48","4090d307.790d8c","4f241a2b.ecf634"]]},{"id":"9bef45bf.0a9f48","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":737.3155364990234,"y":613.4977884292603,"wires":[]},{"id":"b77aefd9.bb4af","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":441.8760681152344,"y":540.8410358428955,"wires":[["f49be8da.0e7028"]]},{"id":"54d0e802.09f878","type":"function","z":"aa66d99.61a3528","name":"Parsing Station","func":"var station = msg.payload.toString().substr(78, 4);\nmsg.payload = station;\n\nreturn msg;","outputs":1,"noerr":0,"x":594.6357116699219,"y":660.881591796875,"wires":[["4b8b105c.237a2"]]},{"id":"4b8b105c.237a2","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":780.6488723754883,"y":660.4977827072144,"wires":[]},{"id":"6f3faeee.73752","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":441.8760681152344,"y":660.8410358428955,"wires":[["54d0e802.09f878"]]},{"id":"6ddf169.0d61fe8","type":"function","z":"aa66d99.61a3528","name":"Parsing Data","func":"var data = msg.payload.toString().substr(92, 24);\nmsg.payload = data;\n\nreturn msg;","outputs":1,"noerr":0,"x":609.6357116699219,"y":736.881591796875,"wires":[["4ddde73.30dfc18","b4a9c2cf.a641b","89378a61.05a418","6fdc9143.63d02","99ef919a.7b9b1","dff9d222.6d053","7cf71fb3.93488"]]},{"id":"4ddde73.30dfc18","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":592.6011657714844,"y":833.4817485809326,"wires":[]},{"id":"cbd98463.496238","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":440.8760681152344,"y":736.8410358428955,"wires":[["6ddf169.0d61fe8"]]},{"id":"8d2e0cb5.0c4a6","type":"function","z":"aa66d99.61a3528","name":"Parsing AvgSnr","func":"var avgSnr = msg.payload.toString().substr(127, 5);\nmsg.payload = parseFloat(avgSnr);\n\nreturn msg;","outputs":1,"noerr":0,"x":595.6357116699219,"y":1443.881591796875,"wires":[["db439272.d582f","70e3313d.b7003","8473e052.13a77"]]},{"id":"db439272.d582f","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":726.315544128418,"y":1531.497838973999,"wires":[]},{"id":"d349d8f0.d16de8","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":442.8760681152344,"y":1443.8410358428955,"wires":[["8d2e0cb5.0c4a6"]]},{"id":"21b3b33b.c020fc","type":"function","z":"aa66d99.61a3528","name":"Parsing GPS","func":"//var LatLng = msg.payload.toString().substr(143, 7);\n//msg.payload = LatLng;\n// -34,151\nvar Lat = msg.payload.toString().substr(143, 3);\nvar Lon = msg.payload.toString().substr(147, 3);\n\nmsg.payload = \"Latitude : \" + Lat + \" \" + \"Longitude : \" + Lon;\n\nreturn msg;","outputs":1,"noerr":0,"x":586.6357116699219,"y":1574.881591796875,"wires":[["8e1f2fd0.21a6b","24cf0c8a.a59414","a261f5c2.251838"]]},{"id":"8e1f2fd0.21a6b","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":757.3155212402344,"y":1670.4977431297302,"wires":[]},{"id":"7be30da4.9f93c4","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":443.8760681152344,"y":1574.8410358428955,"wires":[["21b3b33b.c020fc"]]},{"id":"16bb2da3.8bf6a2","type":"function","z":"aa66d99.61a3528","name":"Parsing RSSI","func":"var rssi = msg.payload.toString().substr(159, 4);\nmsg.payload = parseFloat(rssi);\n\nreturn msg;","outputs":1,"noerr":0,"x":600.240966796875,"y":1713.8552856445312,"wires":[["10a79911.f6a767","bf0ad9a8.04db08","58ddcfba.2e528"]]},{"id":"10a79911.f6a767","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":736.9207725524902,"y":1804.4715967178345,"wires":[]},{"id":"1e06166a.db135a","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":447.4813232421875,"y":1713.8147296905518,"wires":[["16bb2da3.8bf6a2"]]},{"id":"43914d7b.2112a4","type":"function","z":"aa66d99.61a3528","name":"Parsing seqNumber","func":"var seqNumber = msg.payload.toString().substr(176, 3);\nmsg.payload = seqNumber;\n\nreturn msg;","outputs":1,"noerr":0,"x":617.3401794433594,"y":1849.355224609375,"wires":[["fe40a2a6.0815a"]]},{"id":"fe40a2a6.0815a","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":814.0199890136719,"y":1848.9714374542236,"wires":[]},{"id":"8ea495b3.df6208","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":444.5805358886719,"y":1849.3146686553955,"wires":[["43914d7b.2112a4"]]},{"id":"7ad4017.65438","type":"function","z":"aa66d99.61a3528","name":"Parsing Name","func":"var name = msg.payload.toString().substr(188, 3);\nmsg.payload = name;\n\nreturn msg;","outputs":1,"noerr":0,"x":600.6735229492188,"y":1911.0219116210938,"wires":[["cc3414b.d5804e8"]]},{"id":"cc3414b.d5804e8","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":817.3533325195312,"y":1910.6381244659424,"wires":[]},{"id":"36ef7c5f.7a34e4","type":"json","z":"aa66d99.61a3528","name":"","pretty":false,"x":447.91387939453125,"y":1910.9813556671143,"wires":[["7ad4017.65438"]]},{"id":"b4a9c2cf.a641b","type":"function","z":"aa66d99.61a3528","name":"Parsing Temperature","func":"var t1 = msg.payload.substr(0, 2);\nvar t2 = msg.payload.substr(2, 2);\n\nvar h1 = '0x' + t1;\nvar h2 = '0x' + t2;\n\nmsg.payload = (parseInt(h1 + h2))/100;\n\nreturn msg;","outputs":1,"noerr":0,"x":888.2123413085938,"y":737.6774376763237,"wires":[["24427730.9fc358","81e452d4.bd5c7","e212c919.27d988","17bc61bf.ad8f3e"]]},{"id":"24427730.9fc358","type":"debug","z":"aa66d99.61a3528","name":"","active":true,"console":"false","complete":"false","x":1089.491943359375,"y":811.5998287200928,"wires":[]},{"id":"81e452d4.bd5c7","type":"ui_gauge","z":"aa66d99.61a3528","name":"","group":"cc0f0479.6cf808","order":1,"width":0,"height":0,"gtype":"gage","title":"Temperature [ 째C ]","label":"[ 째C ]","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":1111.712013244629,"y":738.5921421051025,"wires":[]},{"id":"89378a61.05a418","type":"function","z":"aa66d99.61a3528","name":"Parsing Pressure","func":"var p1 = msg.payload.substr(4, 2);\nvar p2 = msg.payload.substr(6, 2);\n\nvar h1 = '0x' + p1;\nvar h2 = '0x' + p2;\n\nmsg.payload = (parseInt(h1 + h2))*3;\n\nreturn msg;","outputs":1,"noerr":0,"x":882.6734619140625,"y":850.355224609375,"wires":[["3b73c9de.34c576","bc7d8418.6be9a8","e6bfdb90.ca9b28"]]},{"id":"3b73c9de.34c576","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":1093.9530944824219,"y":922.2776193618774,"wires":[]},{"id":"bc7d8418.6be9a8","type":"ui_gauge","z":"aa66d99.61a3528","name":"","group":"ebb68fa3.34d5c","order":1,"width":0,"height":0,"gtype":"gage","title":"Pressure [ Pa ]","label":"[ Pa ]","format":"{{value}}","min":0,"max":"10000","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":1106.1731338500977,"y":851.2699290381538,"wires":[]},{"id":"6fdc9143.63d02","type":"function","z":"aa66d99.61a3528","name":"Parsing Photo","func":"var ph1 = msg.payload.substr(8, 2);\nvar ph2 = msg.payload.substr(10, 2);\n\nvar h1 = '0x' + ph1;\nvar h2 = '0x' + ph2;\n\nmsg.payload = parseInt(h1 + h2)/1000;\n\nreturn msg;","outputs":1,"noerr":0,"x":876.0068359375,"y":959.0219116210938,"wires":[["cff85a7a.209a98","bbdd054a.ffc858","8548b948.3b6cf8"]]},{"id":"cff85a7a.209a98","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":1098.2864990234375,"y":1034.9443197250366,"wires":[]},{"id":"bbdd054a.ffc858","type":"ui_gauge","z":"aa66d99.61a3528","name":"","group":"be0122a7.bb908","order":1,"width":0,"height":0,"gtype":"gage","title":"Photo  [ V ]","label":"[ V ]","format":"{{value}}","min":0,"max":"5","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":1099.5065078735352,"y":959.9366160498726,"wires":[]},{"id":"99ef919a.7b9b1","type":"function","z":"aa66d99.61a3528","name":"Parsing X_Acc","func":"var xa1 = msg.payload.substr(12, 2);\nvar xa2 = msg.payload.substr(14, 2);\n\nvar h1 = '0x' + xa1;\nvar h2 = '0x' + xa2;\n\nmsg.payload = parseInt(h1 + h2)/250;\n\nreturn msg;","outputs":1,"noerr":0,"x":870.3402099609375,"y":1078.6885986328125,"wires":[["457e872.c21cd78","c8a51e10.4a674","f5b1e6c6.c3fa58"]]},{"id":"457e872.c21cd78","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":1091.6198120117188,"y":1154.6109896765815,"wires":[]},{"id":"c8a51e10.4a674","type":"ui_text","z":"aa66d99.61a3528","group":"75fe1cbc.54cbf4","order":1,"width":0,"height":0,"name":"","label":"X_Acc :","format":"{{msg.payload}} [ g ]","layout":"row-spread","x":1084.4817123413086,"y":1077.9657344818115,"wires":[]},{"id":"dff9d222.6d053","type":"function","z":"aa66d99.61a3528","name":"Parsing Y_Acc","func":"var ya1 = msg.payload.substr(16, 2);\nvar ya2 = msg.payload.substr(18, 2);\n\nvar h1 = '0x' + ya1;\nvar h2 = '0x' + ya2;\n\nmsg.payload = parseInt(h1 + h2)/250;\n\nreturn msg;","outputs":1,"noerr":0,"x":871.7277221679688,"y":1198.9285888671875,"wires":[["dcaa8f15.f6bca","e550ddd0.9d963","39a0d804.7fee58"]]},{"id":"dcaa8f15.f6bca","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":1093.00732421875,"y":1271.8509799109565,"wires":[]},{"id":"e550ddd0.9d963","type":"ui_text","z":"aa66d99.61a3528","group":"75fe1cbc.54cbf4","order":2,"width":0,"height":0,"name":"","label":"Y_Acc :","format":"{{msg.payload}} [ g ]","layout":"row-spread","x":1085.8692245483398,"y":1198.2057247161865,"wires":[]},{"id":"7cf71fb3.93488","type":"function","z":"aa66d99.61a3528","name":"Parsing Z_Acc","func":"var za1 = msg.payload.substr(20, 2);\nvar za2 = msg.payload.substr(22, 2);\n\nvar h1 = '0x' + za1;\nvar h2 = '0x' + za2;\n\nmsg.payload = parseInt(h1 + h2)/250;\n\nreturn msg;","outputs":1,"noerr":0,"x":870.2991333007812,"y":1320.21435546875,"wires":[["a6ad7422.6341c8","37886d1b.8f84d2","ca8d3c9b.bdf93"]]},{"id":"a6ad7422.6341c8","type":"debug","z":"aa66d99.61a3528","name":"","active":false,"console":"false","complete":"false","x":1091.5787353515625,"y":1393.136746512519,"wires":[]},{"id":"37886d1b.8f84d2","type":"ui_text","z":"aa66d99.61a3528","group":"75fe1cbc.54cbf4","order":3,"width":0,"height":0,"name":"","label":"Z_Acc :","format":"{{msg.payload}} [ g ]","layout":"row-spread","x":1084.4406356811523,"y":1319.491491317749,"wires":[]},{"id":"1b29e385.f8e8fc","type":"ui_text","z":"aa66d99.61a3528","group":"9b16f3cb.f9612","order":0,"width":0,"height":0,"name":"","label":"Device :","format":"{{msg.payload}} ","layout":"row-spread","x":767.9556274414062,"y":245.0263214111328,"wires":[]},{"id":"4090d307.790d8c","type":"ui_text","z":"aa66d99.61a3528","group":"2f7f82bd.1d62ee","order":1,"width":0,"height":0,"name":"","label":"SNR :","format":"{{msg.payload}} [ dB ]","layout":"row-spread","x":739.5690650939941,"y":540.3223133087158,"wires":[]},{"id":"24cf0c8a.a59414","type":"ui_text","z":"aa66d99.61a3528","group":"4e11cdbd.0c9894","order":0,"width":0,"height":0,"name":"","label":"","format":"{{msg.payload}}","layout":"row-spread","x":769.582218170166,"y":1574.2698183059692,"wires":[]},{"id":"70e3313d.b7003","type":"ui_text","z":"aa66d99.61a3528","group":"2f7f82bd.1d62ee","order":2,"width":0,"height":0,"name":"","label":"Average SNR :","format":"{{msg.payload}} [ dB ]","layout":"row-spread","x":803.5707397460936,"y":1445.27961730957,"wires":[]},{"id":"bf0ad9a8.04db08","type":"ui_text","z":"aa66d99.61a3528","group":"13a7b6cc.663f29","order":0,"width":0,"height":0,"name":"","label":"RSSI :","format":"{{msg.payload}} [ dBm ]","layout":"row-spread","x":767.5650024414061,"y":1715.2738800048826,"wires":[]},{"id":"e212c919.27d988","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"cc0f0479.6cf808","order":2,"width":0,"height":0,"label":"Temperature [ 째C ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1116.1775545392716,"y":773.6041891915457,"wires":[[],[]]},{"id":"4f241a2b.ecf634","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"2f7f82bd.1d62ee","order":0,"width":0,"height":0,"label":"SNR [ dB ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":760.364044189453,"y":575.9341888427733,"wires":[[],[]]},{"id":"58ddcfba.2e528","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"13a7b6cc.663f29","order":0,"width":0,"height":0,"label":"RSSI [ dB ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":789.372833251953,"y":1753.9385833740232,"wires":[[],[]]},{"id":"a261f5c2.251838","type":"ui_template","z":"aa66d99.61a3528","group":"4e11cdbd.0c9894","name":"","order":0,"width":"6","height":"8","format":"<!DOCTYPE html>\n<html>\n  <head>\n    <title>Geolocation</title>\n    <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=yes\">\n    <meta charset=\"utf-8\">\n    <style>\n      /* Always set the map height explicitly to define the size of the div\n       * element that contains the map. */\n      #map {\n        height: 100%;\n      }\n      /* Optional: Makes the sample page fill the window. */\n      html, body {\n        height: 100%;\n        margin: 0;\n        padding: 0;\n      }\n    </style>\n  </head>\n  <body>\n    <div id=\"map\"></div>\n    <script>\n      // Note: This example requires that you consent to location sharing when\n      // prompted by your browser. If you see the error \"The Geolocation service\n      // failed.\", it means you probably did not give permission for the browser to\n      // locate you.\n      var map, infoWindow;\n      function initMap() {\n        map = new google.maps.Map(document.getElementById('map'), {\n          center: {lat: -33.8718172, lng: 151.22357009999996},\n          zoom: 10\n        });\n        infoWindow = new google.maps.InfoWindow;\n\n        // Try HTML5 geolocation.\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(function(position) {\n            var pos = {\n              lat: position.coords.latitude,\n              lng: position.coords.longitude\n            };\n\n            infoWindow.setPosition(pos);\n            infoWindow.setContent('Location found.');  \n            infoWindow.open(map);\n            map.setCenter(pos);\n          }, function() {\n            handleLocationError(true, infoWindow, map.getCenter());\n          });\n        } else {\n          // Browser doesn't support Geolocation\n          handleLocationError(false, infoWindow, map.getCenter());\n        }\n      }\n\n      function handleLocationError(browserHasGeolocation, infoWindow, pos) {\n        infoWindow.setPosition(pos);\n        infoWindow.setContent(browserHasGeolocation ?\n                              'Error: The Geolocation service failed.' :\n                              'Error: Your browser doesn\\'t support geolocation.');\n        infoWindow.open(map);\n      }\n    </script>\n    \n    <script \n       async defer src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyCZGidTDaBe3A7Jekh0Gy45BFKG_aKcTnU&callback=initMap\">\n    </script>\n    \n  </body>\n</html>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":778.3594589233398,"y":1619.850640296936,"wires":[["416b781d.4287e8"]]},{"id":"be1c7906.1da588","type":"template","z":"aa66d99.61a3528","name":"SigFox with Arduino","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!DOCTYPE html>\n<html>\n  <head>\n    <style>\n       #map {\n        height: 400px;\n        width: 100%;\n       }\n    </style>\n  </head>\n  <body>\n    <h2>Where is my IoT device (by SigFox)?</h2>\n\n    <h2>My IoT Device Location: Latitude: {{payload.latitude}}  , Longitude: {{payload.longitude}} </h2>\n    <div id=\"map\"></div>\n    <script>\n      function initMap() {\n        var IoTDevice = {lat: {{payload.latitude}},lng: {{payload.longitude}} };\n        var map = new google.maps.Map(document.getElementById('map'), {\n          zoom: 13,\n          center: IoTDevice\n        });\n        var marker = new google.maps.Marker({\n          position: IoTDevice,\n          map: map\n        });\n      }\n    </script>\n    <script async defer\n        src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyCZGidTDaBe3A7Jekh0Gy45BFKG_aKcTnU&callback=initMap\">\n    </script>\n    \n    <iframe src=\"http://ec2-54-153-177-45.ap-southeast-2.compute.amazonaws.com:1880/ui/#/2\" width=\"100%\" height=\"1000\" scrolling=\"yes\">\n       <p>Your browser does not support iframes.</p>\n    </iframe>\n    \n  </body>\n</html>","x":1309.653434753418,"y":221.71867752075195,"wires":[["3b0b545.fbc4bac"]]},{"id":"a2e608b3.7515a8","type":"http in","z":"aa66d99.61a3528","name":"/sigfox","url":"/sigfox","method":"get","upload":false,"swaggerDoc":"","x":1035.3677825927734,"y":124.57582092285156,"wires":[["a431f786.912468"]]},{"id":"3b0b545.fbc4bac","type":"http response","z":"aa66d99.61a3528","name":"","statusCode":"","headers":{},"x":1462.5106468200684,"y":270.29010009765625,"wires":[]},{"id":"a431f786.912468","type":"function","z":"aa66d99.61a3528","name":"RemoteData","func":"msg.payload = {'latitude':-33.8718172,'longitude':151.22357009999996};\nreturn msg;","outputs":1,"noerr":0,"x":1149.6535415649414,"y":174.5758056640625,"wires":[["be1c7906.1da588"]]},{"id":"f305e9f0.8d1f58","type":"mqtt out","z":"aa66d99.61a3528","name":"","topic":"cback","qos":"2","retain":"","broker":"954cd2e.c49463","x":495.6820526123047,"y":149.11841583251953,"wires":[]},{"id":"416b781d.4287e8","type":"debug","z":"aa66d99.61a3528","name":"","active":true,"console":"false","complete":"false","x":938.9340591430664,"y":1621.1381216049194,"wires":[]},{"id":"8548b948.3b6cf8","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"be0122a7.bb908","order":0,"width":0,"height":0,"label":"Photo [ V ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1102.2911071777344,"y":996.6772232055664,"wires":[[],[]]},{"id":"e6bfdb90.ca9b28","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"ebb68fa3.34d5c","order":0,"width":0,"height":0,"label":"Pressure [ Pa ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1107.6910705566406,"y":886.3907604217529,"wires":[[],[]]},{"id":"18cf517f.17cbcf","type":"comment","z":"aa66d99.61a3528","name":"Web","info":"","x":1013.0731887817383,"y":45.68608379364014,"wires":[]},{"id":"8473e052.13a77","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"2f7f82bd.1d62ee","order":0,"width":0,"height":0,"label":"Average SNR [ dB ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":814.3868713378905,"y":1483.3427058628627,"wires":[[],[]]},{"id":"f5b1e6c6.c3fa58","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"75fe1cbc.54cbf4","order":0,"width":0,"height":0,"label":"X_Acc [ g ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1097.1023777553012,"y":1116.3260258265902,"wires":[[],[]]},{"id":"39a0d804.7fee58","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"75fe1cbc.54cbf4","order":0,"width":0,"height":0,"label":"Y_Acc [ g ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1097.1064758300781,"y":1234.179557800293,"wires":[[],[]]},{"id":"ca8d3c9b.bdf93","type":"ui_chart","z":"aa66d99.61a3528","name":"","group":"75fe1cbc.54cbf4","order":0,"width":0,"height":0,"label":"Z_Acc [ g ]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1096.1011570521762,"y":1355.462430681501,"wires":[[],[]]},{"id":"85117879.3ee018","type":"ui_text","z":"aa66d99.61a3528","group":"d53b0f9e.286b","order":0,"width":0,"height":0,"name":"","label":"","format":"{{msg.payload}}","layout":"row-spread","x":1189.3570556640625,"y":330.9851264953613,"wires":[]},{"id":"5bb2a26d.d0dcec","type":"moment","z":"aa66d99.61a3528","name":"","topic":"","input":"payload","inputType":"msg","inTz":"UTC","adjAmount":"11","adjType":"hours","adjDir":"add","format":"","locale":"AEDT","output":"payload","outputType":"msg","outTz":"ETC/GMT","x":854.7840728759766,"y":332.25842666625977,"wires":[["14f1a3f5.5911fc"]]},{"id":"5f16818f.2a8f1","type":"function","z":"aa66d99.61a3528","name":"Parsing Sydney Time","func":"var timeStamp = msg.payload.toString().substr(26, 10);\nmsg.payload = timeStamp;\n\nreturn msg;\n","outputs":1,"noerr":0,"x":624.2916259765625,"y":331.4473876953125,"wires":[["5bb2a26d.d0dcec"]]},{"id":"14f1a3f5.5911fc","type":"function","z":"aa66d99.61a3528","name":"Parsing Time","func":"var time = msg.payload.toString().substr(0, 19).replace(\"T\",\" \");\nmsg.payload = time;\n\nreturn msg;\n","outputs":1,"noerr":0,"x":1045.8989181518555,"y":332.0131301879883,"wires":[["85117879.3ee018","994c0c95.940e2"]]},{"id":"a3e3b707.5fcb88","type":"function","z":"aa66d99.61a3528","name":"timestamp","func":"var timeStamp = msg.payload.toString().substr(26, 10);\nmsg.payload = timeStamp;\nreturn msg;","outputs":1,"noerr":0,"x":598.0833740234375,"y":404.2218933105469,"wires":[["94d60f17.e6ef7","6cfb09d7.c7e408","446a97ca.0b0498"]]},{"id":"94d60f17.e6ef7","type":"debug","z":"aa66d99.61a3528","name":"","active":true,"console":"false","complete":"false","x":736.4182739257812,"y":449.812219619751,"wires":[]},{"id":"3a33051d.4d20da","type":"inject","z":"aa66d99.61a3528","name":"create database table","topic":"CREATE TABLE HOME( TIME INT PRIMARY KEY NOT NULL, LOCAL INT NOT NULL, TEMP INT NOT NULL)","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":1782.9998626708984,"y":502.2519333958626,"wires":[["1dfaae2e.78b732"]]},{"id":"7243415.da2c5c","type":"function","z":"aa66d99.61a3528","name":"Insert query","func":"//var time = msg.payload.substr(0, 18);\n//var temp01 = msg.payload.substr(17, 5);\n//var temp = parseFloat(temp01);\n\nvar time = msg.payload.data.time;\nvar local = msg.payload.data.local;\nvar temp = msg.payload.data.temp;\n\n//var temp = msg.payload;\n//var largeBool = (temp > 30)?1:0;\nvar newMsg = {\n \"topic\": \"INSERT INTO HOME VALUES ( \" + time + \", \" + local + \", \" + temp + \")\"\n};\n\nreturn newMsg;\n\n\n/*\nvar randomNum = Math.round(Math.random()*100);\nvar largeBool = (randomNum > 50)?1:0;\nvar newMsg = {\n \"topic\": \"INSERT INTO RANDOMNUM VALUES ( \" + msg.payload + \", \" + randomNum + \", \" + largeBool + \")\"\n}\n\nreturn newMsg;\n*/","outputs":1,"noerr":0,"x":1771.3620300292969,"y":545.0020125508308,"wires":[["1dfaae2e.78b732"]]},{"id":"b8e81218.262bb","type":"inject","z":"aa66d99.61a3528","name":"view records","topic":"SELECT * FROM HOME ORDER BY TIME DESC LIMIT 100;","payload":"","payloadType":"date","repeat":"10","crontab":"","once":false,"x":1821.7498054504395,"y":674.251967728138,"wires":[["e62b0c31.ca53b"]]},{"id":"4f1906bf.2806f8","type":"inject","z":"aa66d99.61a3528","name":"delete records","topic":"DELETE FROM HOME WHERE TIME <= strftime('%s','now', '-1 hours')*1000","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":1816.969123840332,"y":631.0020135045052,"wires":[["1dfaae2e.78b732"]]},{"id":"acaf581e.c25b68","type":"inject","z":"aa66d99.61a3528","name":"show counts ","topic":"SELECT COUNT(*) FROM HOME","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":1817.2497673034668,"y":589.752003967762,"wires":[["1dfaae2e.78b732"]]},{"id":"6cfb09d7.c7e408","type":"moment","z":"aa66d99.61a3528","name":"","topic":"","input":"","inputType":"msg","inTz":"ETC/GMT","adjAmount":"11","adjType":"hours","adjDir":"add","format":"","locale":"AEDT","output":"payload","outputType":"msg","outTz":"ETC/GMT","x":1339.6069259643555,"y":415.8482878804207,"wires":[["c8099349.b5c5c"]]},{"id":"c8099349.b5c5c","type":"function","z":"aa66d99.61a3528","name":"Parsing Time","func":"var time = msg.payload.toString().substr(0, 19).replace(\"T\",\" \");\nmsg.payload = time;\n\n\nreturn msg;\n","outputs":1,"noerr":0,"x":1529.4998245239258,"y":416.0860841870308,"wires":[["7e1352dc.5c4e5c","3c861a3a.4eb656"]]},{"id":"17bc61bf.ad8f3e","type":"delay","z":"aa66d99.61a3528","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1326.124984741211,"y":548.1921265721321,"wires":[["446a97ca.0b0498"]]},{"id":"446a97ca.0b0498","type":"join","z":"aa66d99.61a3528","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":" ","joinerType":"str","accumulate":false,"timeout":"","count":"3","x":1492.4504699707031,"y":545.4920442700386,"wires":[["4fb92baa.b471f4"]]},{"id":"4fb92baa.b471f4","type":"function","z":"aa66d99.61a3528","name":"JSON","func":"// \"2017-11-25 14:53:26 11.36\"\n// \"1511589899 17.76\"\n// \"1511607089 2017-11-25 21:51:29 4.48\"\n\n//var time = msg.payload.toString().substr(0, 19);\nvar time01 = msg.payload.toString().substr(0, 10);\nvar localMon = msg.payload.toString().substr(16, 2);\nvar localD = msg.payload.toString().substr(19, 2);\nvar localH = msg.payload.toString().substr(22, 2);\nvar localMin = msg.payload.toString().substr(25, 2);\nvar temp01 = msg.payload.toString().substr(31, 5);\n\nvar time = parseFloat(time01);\nvar local = parseFloat(localMon + localD + localH + localMin); \nvar temp = parseFloat(temp01);\n\nmsg.payload = {data:{time,local,temp}};\n\n\nreturn msg;","outputs":1,"noerr":0,"x":1622.4567260742188,"y":544.5838025212288,"wires":[["7243415.da2c5c","e8d54f10.4dffc","832f2e14.03c42"]]},{"id":"7e1352dc.5c4e5c","type":"ui_text","z":"aa66d99.61a3528","group":"88a48691.805308","order":1,"width":0,"height":0,"name":"","label":"Date","format":"{{msg.payload}}","layout":"row-spread","x":1691.0923480987549,"y":416.0369184613228,"wires":[]},{"id":"3142b1f7.1cad9e","type":"ui_button","z":"aa66d99.61a3528","name":"","group":"88a48691.805308","order":2,"width":0,"height":0,"passthru":false,"label":"Delete SQL Records","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"DELETE FROM HOME WHERE TIME <= strftime('%s','now', '-1 hours')*1000","x":1795.3351211547852,"y":464.0496161580086,"wires":[["1dfaae2e.78b732"]]},{"id":"96de972e.009fe8","type":"comment","z":"aa66d99.61a3528","name":"SQLite Part","info":"","x":1419.999900817871,"y":346.91862511634827,"wires":[]},{"id":"852cfb45.53f888","type":"ui_template","z":"aa66d99.61a3528","group":"88a48691.805308","name":"UI Table","order":3,"width":"6","height":"8","format":"<table style=\"width:100%\">\n <tr>\n <th>Index</th>\n <th></th>\n <th>DATE</th>\n <th>TEMP [째C]</th>\n </tr>\n <tr ng-repeat=\"x in msg.payload | limitTo:30\">\n <td>{{$index + 1}}</td>\n <td></td>\n <td>{{msg.payload[$index].LOCAL}}</td>\n <td>{{msg.payload[$index].TEMP}}</td>\n </tr>\n</table>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2237.9998626708984,"y":674.2519333958626,"wires":[[]]},{"id":"e62b0c31.ca53b","type":"sqlite","z":"aa66d99.61a3528","mydb":"dfb5edd.b0c5c1","name":"","x":2037.999755859375,"y":673.7520001530647,"wires":[["852cfb45.53f888"]]},{"id":"1dfaae2e.78b732","type":"sqlite","z":"aa66d99.61a3528","mydb":"dfb5edd.b0c5c1","name":"","x":2062.9998626708984,"y":544.2519333958626,"wires":[[]]},{"id":"3c861a3a.4eb656","type":"delay","z":"aa66d99.61a3528","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1538.6033477783203,"y":489.0306504368782,"wires":[["446a97ca.0b0498"]]},{"id":"17fa9a5b.f26ed6","type":"sqlite","z":"aa66d99.61a3528","mydb":"dfb5edd.b0c5c1","name":"","x":2029.2071685791016,"y":735.9555466771126,"wires":[["b8bf8b1f.72db78","6c8894ed.b8358c"]]},{"id":"7342ba14.f110e4","type":"ui_text_input","z":"aa66d99.61a3528","name":"","label":"","group":"64a4e3.267d8b1c","order":2,"width":0,"height":0,"passthru":true,"mode":"text","delay":300,"topic":"","x":1823.724437713623,"y":788.8942127227783,"wires":[["23ec6737.7a2d08"]]},{"id":"b8bf8b1f.72db78","type":"debug","z":"aa66d99.61a3528","name":"","active":true,"console":"false","complete":"false","x":2261.825439453125,"y":778.1038907170296,"wires":[]},{"id":"23ec6737.7a2d08","type":"function","z":"aa66d99.61a3528","name":"JSON Msg","func":"// SELECT * FROM HOME WHERE TEMP = 34;\n\nvar newMsg = {\n \"topic\": msg.payload\n};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1838.1660842895508,"y":735.8829835057259,"wires":[["17fa9a5b.f26ed6"]]},{"id":"6c8894ed.b8358c","type":"ui_template","z":"aa66d99.61a3528","group":"64a4e3.267d8b1c","name":"Query Answer","order":3,"width":"6","height":"8","format":"<table style=\"width:100%\">\n <tr>\n  <th>Index</th>     \n <th>ANSWER</th>\n </tr>\n <tr ng-repeat=\"x in msg.payload | limitTo:500\">\n <td>{{$index + 1}}</td>\n <td>{{msg.payload[$index]}}</td>\n </tr>\n</table>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2269.645866394043,"y":735.5072577595711,"wires":[[]]},{"id":"efa851ca.736ff","type":"ui_template","z":"aa66d99.61a3528","group":"64a4e3.267d8b1c","name":"Example","order":1,"width":"0","height":"0","format":"<!DOCTYPE html>\n<html>\n<body>\n<strong>Example :</strong>\n<p>SELECT * FROM HOME WHERE TEMP = 11.04</p>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":2247.9791412353516,"y":823.8405564427376,"wires":[[]]},{"id":"994c0c95.940e2","type":"mqtt out","z":"aa66d99.61a3528","name":"","topic":"timetosql","qos":"2","retain":"","broker":"954cd2e.c49463","x":1208.7721862792969,"y":277.23979091644287,"wires":[]},{"id":"e8d54f10.4dffc","type":"mqtt out","z":"aa66d99.61a3528","name":"MQTT - arduinoTempSensor","topic":"arduinoTempSensor","qos":"2","retain":"","broker":"538f8f38.aa2cf","x":1824.6762199401855,"y":840.9053649902344,"wires":[]},{"id":"832f2e14.03c42","type":"debug","z":"aa66d99.61a3528","name":"","active":true,"console":"false","complete":"false","x":1783.0081685384112,"y":909.2812601725259,"wires":[]},{"id":"cc0f0479.6cf808","type":"ui_group","z":"","name":"Temperature","tab":"a620826e.45488","order":6,"disp":true,"width":"6"},{"id":"ebb68fa3.34d5c","type":"ui_group","z":"","name":"Pressure","tab":"a620826e.45488","order":7,"disp":true,"width":"6"},{"id":"be0122a7.bb908","type":"ui_group","z":"","name":"Photo","tab":"a620826e.45488","order":8,"disp":true,"width":"6"},{"id":"75fe1cbc.54cbf4","type":"ui_group","z":"","name":"Accelerometer","tab":"a620826e.45488","order":9,"disp":true,"width":"6"},{"id":"9b16f3cb.f9612","type":"ui_group","z":"","name":"Device","tab":"a620826e.45488","order":3,"disp":true,"width":"6"},{"id":"2f7f82bd.1d62ee","type":"ui_group","z":"","name":"SNR","tab":"a620826e.45488","order":10,"disp":true,"width":"6"},{"id":"4e11cdbd.0c9894","type":"ui_group","z":"","name":"GPS","tab":"a620826e.45488","order":4,"disp":true,"width":"6"},{"id":"13a7b6cc.663f29","type":"ui_group","z":"","name":"RSSI","tab":"a620826e.45488","order":11,"disp":true,"width":"6"},{"id":"954cd2e.c49463","type":"mqtt-broker","z":"","broker":"iot.eclipse.org","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"willTopic":"","willQos":"0","willPayload":"","birthTopic":"","birthQos":"0","birthPayload":""},{"id":"d53b0f9e.286b","type":"ui_group","z":"","name":"Time","tab":"a620826e.45488","order":1,"disp":true,"width":"6"},{"id":"88a48691.805308","type":"ui_group","z":"","name":"SQLite SigFox","tab":"a620826e.45488","order":5,"disp":true,"width":"6"},{"id":"dfb5edd.b0c5c1","type":"sqlitedb","z":"","db":"/home/ubuntu/sqliteIoT"},{"id":"64a4e3.267d8b1c","type":"ui_group","z":"","name":"Query Commander","tab":"a620826e.45488","order":2,"disp":true,"width":"6"},{"id":"538f8f38.aa2cf","type":"mqtt-broker","z":"","broker":"iot.eclipse.org","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"willTopic":"","willQos":"0","willPayload":"","birthTopic":"","birthQos":"0","birthPayload":""},{"id":"a620826e.45488","type":"ui_tab","z":"","name":"SigFox with Arduino","icon":"dashboard","order":3}]
```

![SigFoxWithSQLiteMQTT_NodeRED.png](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/01_Images/SigFoxWithSQLiteMQTT_NodeRED.png)

![SigFoxWithSQLiteMQTT.png](https://github.com/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/01_Images/SigFoxWithSQLiteMQTT.png)

***
## Python Jupyter-notebook In Real Time

[Source Code: Python Jupyter-notebook](http://nbviewer.jupyter.org/github/leehaesung/NodeRED/blob/master/02_CodeFiles/11_SigFox/02_SourceCodes/SQLite3_with_Monitoring_IoT_Arduino_Temp_Sensor_MQTT.ipynb)



***

## References

* Materials https://www.thinxtra.com/xkit/
* Where To Buy: https://www.iot-store.com.au/products/thinxtra-xkit4-first-complete-sigfox-ready-development-kit
* Coverage in the world: https://www.sigfox.com/en/coverage

***
